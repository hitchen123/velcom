"use strict";var MobileDetect=MobileDetect||require("../../mobile-detect.js"),mobilePerVendor=mobilePerVendor||require("../data/user-agents.js"),matchers;function createMatcher(a){return function(b){var c=this.actual;this.message=function(){var d=[];if(c.nr){d.push("nr="+c.nr)}if(!b){d.push('returned "'+c[a]()+'"')}if(d.length){d.push("")}return"Expected device"+(b?" ":" not ")+"to be "+a+" ("+d.join(", ")+c.ua+")"};return(c[a]()!==null)===b}}matchers={toBeMobile:createMatcher("mobile"),toBePhone:createMatcher("phone"),toBeTablet:createMatcher("tablet")};beforeEach(function(){this.addMatchers(matchers)});describe("MobileDetect (1 example)",function(){var a;beforeEach(function(){a=new MobileDetect("Mozilla/5.0 (Linux; U; Android 4.0.3; en-in; SonyEricssonMT11i Build/4.1.A.0.562) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",-1)});it("should detect OS",function(){expect(a.os()).toEqual("AndroidOS")});it("should extract mobile/phone/tablet device",function(){expect(a.mobile()).toEqual("Sony");expect(a.phone()).toEqual("Sony");expect(a.tablet()).toBeNull()});it("should rank mobile grade",function(){expect(a.mobileGrade()).toEqual("A")});it("should find out userAgent",function(){expect(a.userAgent()).toEqual("Safari")});it("should extract correct versions",function(){expect(a.version("Android")).toBeCloseTo(4.03,3);expect(a.version("Build")).toBeCloseTo(4.10562,7);expect(a.version("Safari")).toBe(4);expect(a.version("MSIE")).toBeNaN();expect(a.version("MSIE")>=7).toBeFalsy();expect(a.version("MSIE")<7).toBeFalsy()});it("should extract correct version strings",function(){expect(a.versionStr("Android")).toBe("4.0.3");expect(a.versionStr("Build")).toBe("4.1.A.0.562");expect(a.versionStr("Safari")).toBe("4.0");expect(a.versionStr("MSIE")).toBeNull()});it("should answer generic queries",function(){expect(a.is("sony")).toBe(true);expect(a.is("iPhone")).toBe(false);expect(a.is("safari")).toBe(true);expect(a.is("androidOS")).toBe(true)});it("should find raw case-insensitive matches",function(){expect(a.match("mt1.i")).toBe(true);expect(a.match("linux")).toBe(true);expect(a.match("playstation|nintendo|xbox")).toBe(false)});it("should run phone size",function(){expect(a.isPhoneSized(-1)).toBeUndefined();if(typeof window!=="undefined"){expect(a.isPhoneSized(320)).toBe(false);expect(a.isPhoneSized(9999)).toBe(true)}})});describe("Fixing issues",function(){it("should fix issue #1",function(){var a=new MobileDetect("Mozilla/5.0 (Linux; U; Android 4.1.2; en-us; SPH-L710 Build/JZO54K) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",-1);expect(a).toBeMobile(true)});it("should fix issue #2",function(){var a=new MobileDetect();expect(a).toBeMobile(false);expect(a).toBePhone(false);expect(a).toBeTablet(false);expect(a.mobileGrade()).toBe("C");expect(a.version("MSIE")).toBeNaN();expect(a.version("MSIE")>=7).toBeFalsy();expect(a.version("MSIE")<7).toBeFalsy();expect(a.versionStr("MSIE")).toBeNull();expect(a.isPhoneSized()).toBeFalsy();expect(a.match(/xbox/i)).toBeFalsy()});it("should fix issue #5",function(){var a=new MobileDetect("Mozilla/5.0 (Linux; Android 4.4.2; en-us; SAMSUNG SM-T530NU Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/1.5 Chrome/28.0.1500.94 Safari/537.36",-1);expect(a).toBePhone(false);expect(a).toBeTablet(true);expect(a).toBeMobile(true)});it("should fix issue #15",function(){var a=new MobileDetect("Mozilla/5.0 (Mobile; Windows Phone 8.1; Android 4.0; ARM; Trident/7.0; Touch; rv:11.0; IEMobile/11.0; Microsoft; Virtual) like iPhone OS 7_0_3 Mac OS X AppleWebKit/537 (KHTML, like Gecko) Mobile Safari/537",-1);expect(a.os()).toEqual("WindowsPhoneOS")});it("should fix issue #28",function(){var a=new MobileDetect("Mozilla/5.0 (Linux; U; Android 2.2.1; en-us; foo Build/FRG83) AppleWebKit/533.1 (KHTML, like Gecko)",-1);expect(a).toBePhone(false);expect(a).toBeTablet(true);expect(a).toBeMobile(true);expect(a.tablet()).toBe("UnknownTablet")});it("should fix issue #34",function(){var a=new MobileDetect("SAMSUNG-SGH-E250/1.0 Profile/MIDP-2.0 Configuration/CLDC-1.1 UP.Browser/6.2.3.3.c.1.101 (GUI) MMP/2.0 (compatible; Googlebot-Mobile/2.1; +http://www.google.com/bot.html)",-1);expect(a.is("Bot")).toBe(true);expect(a.is("MobileBot")).toBe(true)});it("should fix issue #36",function(){var a=new MobileDetect("Mozilla/5.0 (Linux; U; Android 4.1.2; zh-CN; HUAWEI C8815 Build/HuaweiC8815) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 UCBrowser/10.7.0.634 U3/0.8.0 Mobile Safari/534.30",-1);expect(a.userAgents()).toEqual(["Safari","UCBrowser"]);expect(a.is("UCBrowser")).toBe(true);expect(a.is("Safari")).toBe(true)})});describe("Extensibility",function(){var c,b;function a(e,d){Object.keys(e).forEach(function(f){d[f]=e[f]});return d}beforeEach(function(){c=a(MobileDetect._impl,{});b=c.mobileDetectRules.phones.Sony});afterEach(function(){a(c,MobileDetect._impl);c.mobileDetectRules.phones.Sony=b});it("should make internal 'prepareDetectionCache' possible to delegate",function(){var d,e="Mozilla/5.0 (Mobile; iPhone OS 7_0_3",f=MobileDetect._impl.prepareDetectionCache;d=new MobileDetect(e);expect(d.phone()).toBe("iPhone");MobileDetect._impl.prepareDetectionCache=function(h,i,g){f(h,i,g);h.phone="MySpecialPhone"};d=new MobileDetect(e);expect(d.phone()).toBe("MySpecialPhone");MobileDetect._impl.prepareDetectionCache=f;d=new MobileDetect(e);expect(d.phone()).toBe("iPhone")});it("should make internal 'detectOS' possible to delegate",function(){var d,e="Mozilla/5.0 (Mobile; rv:26.0) Gecko/26.0 Firefox/26.0";d=new MobileDetect(e);expect(d.os()).toBe(null);expect(d.is("FirefoxOS")).toBe(false);MobileDetect._impl.detectOS=function(f){var g=c.detectOS(f);if(g==null){if(/.*(Mobile|Tablet).+\sFirefox\/.*/.test(f)){return"FirefoxOS"}}return g};d=new MobileDetect(e);expect(d.os()).toBe("FirefoxOS");expect(d.is("FirefoxOS")).toBe(true)});it("should be possible to extend the regular expressions",function(){var d=MobileDetect._impl.mobileDetectRules.phones,f="Mozilla/5.0 (Linux; U; Android 4.0.3; asdfghjkl Build/4.1.A.0.562",g,e;e=new MobileDetect(f);expect(e.phone()).toBe(null);expect(e.os()).toBe("AndroidOS");g=d.Sony.source+"|asdfghjkl";d.Sony=new RegExp(g,"i");e=new MobileDetect(f);expect(e.phone()).toBe("Sony");expect(e.os()).toBe("AndroidOS")})});xdescribe("Feeding w/ ualist",function(){function a(d){return function(){var e=mobilePerVendor[d];e.forEach(function(f){b(f)})}}function b(e){var d=new MobileDetect(e.user_agent,-1);d.nr=e.nr;if("mobile" in e){expect(d).toBeMobile(e.mobile)}if("tablet" in e){expect(d).toBeTablet(e.tablet)}if(e.mobile===true&&e.tablet!==undefined){expect(d).toBePhone(!e.tablet)}}var c;for(c in mobilePerVendor){if(Object.prototype.hasOwnProperty.call(mobilePerVendor,c)){it("should detect devices from vendor "+c,a(c))}}});